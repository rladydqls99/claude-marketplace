## Anti-patterns to Avoid

Common mistakes that violate project conventions and should be avoided.

### Architecture & Dependencies

**DO NOT:**

- Create circular dependencies between slices
- Bypass public APIs with direct internal imports
- Add business logic to shared layer
- Import from same layer (e.g., entity → entity)
- Violate FSD layer boundaries

**Example:**

```typescript
// ❌ WRONG - Direct internal import
import { Button } from '@shared/ui/button'

// ✅ CORRECT - Import through public API
import { Button } from '@shared'

// ❌ WRONG - Cross-layer import within entities
import { User } from '@entities/user'
import { Comment } from '@entities/comment'  // entity importing entity

// ✅ CORRECT - Import in feature layer
// features/user-comments/model/
import { User } from '@entities/user'
import { Comment } from '@entities/comment'  // features can import multiple entities
```

### Code Generation & Optimization

**DO NOT:**

- Manually edit `routeTree.gen.ts` (auto-generated by TanStack Router)
- Add unnecessary `useMemo`/`useCallback` (React Compiler handles it)

**Example:**

```typescript
// ❌ WRONG - Manual memoization (React Compiler does this)
const memoizedValue = useMemo(() => expensiveCalculation(a, b), [a, b])

// ✅ CORRECT - Let React Compiler optimize
const value = expensiveCalculation(a, b)

// Note: Only add manual memoization if you've measured a specific performance issue
```

### Styling & Components

**DO NOT:**

- Use direct Hugeicons component imports (use HugeiconsIcon wrapper)
- Use inline styles (use Tailwind classes)
- Create prop types with names other than `Props`

**Example:**

```typescript
// ❌ WRONG - Direct Hugeicons import
import { Database02Icon } from "@hugeicons/react"
<Database02Icon size={16} />

// ✅ CORRECT - Use wrapper with icon data
import { Database02Icon } from "@hugeicons/core-free-icons"
import { HugeiconsIcon } from "@hugeicons/react"
<HugeiconsIcon icon={Database02Icon} strokeWidth={2} className="size-4" />

// ❌ WRONG - Inline styles
<div style={{ padding: '16px', color: 'blue' }}>

// ✅ CORRECT - Tailwind classes
<div className="p-4 text-blue-600">
```

### Functions & Syntax

**DO NOT:**

- Use function declarations (use arrow functions)
- Leave unused imports or variables (will fail build)

**Example:**

```typescript
// ❌ WRONG - Function declaration
export function fetchData() {
  return ky.get('/api/data').json()
}

// ✅ CORRECT - Arrow function
export const fetchData = async () => {
  return await ky.get('/api/data').json()
}

// ❌ WRONG - Unused imports/variables
import { useState, useEffect } from 'react'  // useEffect unused
const unusedVariable = 'test'

// ✅ CORRECT - Only import what you use
import { useState } from 'react'
```

### Forms & Data

**DO NOT:**

- Skip validation with Zod schemas
- Forget error handling in API calls
- Mutate React Query cache directly (use invalidation)

**Example:**

```typescript
// ❌ WRONG - No validation
const data = await ky.get('/api/users').json()

// ✅ CORRECT - Validate with Zod
const data = await ky.get('/api/users').json()
const validatedData = z.array(userSchema).parse(data)

// ❌ WRONG - Direct cache mutation
queryClient.setQueryData(['users'], newData)

// ✅ CORRECT - Invalidate and refetch
queryClient.invalidateQueries({ queryKey: ['users'] })

// ❌ WRONG - No error handling
const result = await createUser(data)

// ✅ CORRECT - Handle errors
try {
  const result = await createUser(data)
  toast.success('User created')
} catch (error) {
  toast.error('Failed to create user')
  console.error(error)
}
```

### File Creation

**DO NOT:**

- Create new files unless absolutely necessary
- Always prefer editing existing files
- This includes markdown files

**Example:**

```typescript
// ❌ WRONG - Creating new component file when similar exists
// Create: src/shared/ui/button-secondary.tsx

// ✅ CORRECT - Edit existing file with variants
// Edit: src/shared/ui/button.tsx
// Add variant prop to handle different styles
```

These anti-patterns are enforced through:
- ESLint rules (architecture, imports)
- TypeScript compiler (unused code)
- Pre-commit hooks (formatting)
- Code review guidelines
